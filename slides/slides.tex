\documentclass[accentcolor = tud11b, colorbacktitle, landscape, german, presentation, tudmathserif]{tudbeamer}

% Core packages.
\usepackage[ngerman]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
% Other packages.
\usepackage{calc}
\usepackage{csquotes}
\usepackage{float}
\usepackage{kbordermatrix}
\usepackage{listings}
\usepackage{makecell}
\usepackage{mathtools}
\usepackage{multicol}
\usepackage{newunicodechar}
\usepackage{stmaryrd}
\usepackage{tabto}
%\usepackage[disable]{todonotes}
\usepackage{todonotes}
% TikZ.
\usepackage{tikz}
\usetikzlibrary{angles, arrows.meta, backgrounds, calc, positioning, shapes}

% Basic information.
\title{Lösung periodischer Fahrplanoptimierungsprobleme durch Modulo-Simplex-Berechnungen}
\institute{Fabian Damken}
\date{\today}

\MakeOuterQuote{"}

\tikzset{> = { Latex[length = 2.5mm] }}
\tikzstyle{every path} = [ very thick ]

\AtBeginSection{
	\begin{frame}{\insertsectionhead \\ Gliederung}
		\tableofcontents[currentsection]
	\end{frame}
}
\AtBeginSubsection{
	\begin{frame}{\insertsubsectionhead \\ Gliederung}
		\tableofcontents[currentsection, currentsubsection]
	\end{frame}
}

% New commands.
\newcommand{\arr}{\mathit{arr}}
\newcommand{\const}{\ensuremath{\textrm{const}}}
\newcommand{\C}{\ensuremath{\mathbb{C}}}
\newcommand{\dep}{\mathit{dep}}
\newcommand{\dif}[1]{\ensuremath{\,\mathrm{d}#1}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
% Matrix and vector notation. Use both boldsymbol and mathbf as the first works
% only for greek letters while the latter works only for latin letters.
\newcommand{\mat}[1]{\boldsymbol{\mathbf{#1}}}
\renewcommand{\vec}[1]{\boldsymbol{\mathbf{#1}}}
\makeatletter
\newcommand{\BIG}{\bBigg@{4}}
\newcommand{\BIGG}{\bBigg@{5}}
\makeatother

\let\oldvdots=\vdots
\renewcommand{\vdots}{\raisebox{2pt}{\(\oldvdots\)}}
\let\oldddots=\ddots
\renewcommand{\ddots}{\raisebox{2pt}{\(\oldddots\)}}

\renewcommand{\kbldelim}{[}
\renewcommand{\kbrdelim}{]}

\newcommand{\zB}{z.\,B.~}

\newunicodechar{−}{--}

\newcommand{\exampleDirectedGraph}{
	\begin{tikzpicture}[->, node/.style = { draw, rectangle, rounded corners, minimum width = 1cm, minimum height = 0.6cm }]
		\node [node] (a) {\(A\)};
		\node [node, right = of a] (b) {\(B\)};
		\node [node, below = of a] (c) {\(C\)};
		\node [node, below = of b] (d) {\(D\)};
		
		\draw (b) -- node[midway, sloped, above]{\(a\)} (a);
		\draw (a) -- node[left]{\(b\)} (c);
		\draw (d) -- node[midway, sloped, above]{\(c\)} (a);
		\draw (b) -- node[right]{\(d\)} (d);
		\draw (c) -- node[midway, sloped, above]{\(e\)} (d);
	\end{tikzpicture}
}
\newcommand{\exampleSpanningTree}{
	\begin{tikzpicture}[node/.style = { draw, rectangle, rounded corners, minimum width = 1cm, minimum height = 0.6cm }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }]
		\node [node] (a) {\(A\)};
		\node [node, right = of a] (b) {\(B\)};
		\node [node, below = of a] (c) {\(C\)};
		\node [node, below = of b] (d) {\(D\)};
		
		\draw [spanning] (b) -- node[midway, sloped, above]{\(a\)} (a);
		\draw [co] (a) -- node[left]{\(b\)} (c);
		\draw [spanning] (d) -- node[midway, sloped, above]{\(c\)} (a);
		\draw [co] (b) -- node[right]{\(d\)} (d);
		\draw [spanning] (c) -- node[midway, sloped, above]{\(e\)} (d);
	\end{tikzpicture}
}
\newcommand{\exampleDirectedSpanningTree}{
	\begin{tikzpicture}[->, node/.style = { draw, rectangle, rounded corners, minimum width = 1cm, minimum height = 0.6cm }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }]
		\node [node] (a) {\(A\)};
		\node [node, right = of a] (b) {\(B\)};
		\node [node, below = of a] (c) {\(C\)};
		\node [node, below = of b] (d) {\(D\)};
		
		\draw [spanning] (b) -- node[midway, sloped, above]{\(a\)} (a);
		\draw [co] (a) -- node[left]{\(b\)} (c);
		\draw [spanning] (d) -- node[midway, sloped, above]{\(c\)} (a);
		\draw [co] (b) -- node[right]{\(d\)} (d);
		\draw [spanning] (c) -- node[midway, sloped, above]{\(e\)} (d);
	\end{tikzpicture}
}

\begin{document}
	\bibliographystyle{alpha}
	
	\begin{titleframe}
		\onslide<2->{\tableofcontents}
	\end{titleframe}

	\section{Einleitung und Motivation}
		\todo{Einleitung und Motivation}
	% end
	
	\section{Mathematische Modellierung}
		\subsection{Nicht-periodische Fahrpläne}
			\begin{frame}{Schienennetz und Ereignisse}
				Ein \emph{Schienennetz} ist ein System von Linien \(\mathcal{L}\) und Stationen \(\mathcal{S}\).
			
				\vspace{1cm}
				Bedient Linie \( L \in \mathcal{L} \) die Station \( S \in \mathcal{S} \), so sei
				\begin{itemize}
					\item \( (L, \arr, S) \) \tabto{1.7cm} das Ankunfts- und
					\item \( (L, \dep, S) \) \tabto{1.7cm} das Abfahrts-\emph{Ereignis}.
				\end{itemize}
			
				Eine Linie ist eine alternierende Sequenz von Ankunfts- und Abfahrts-Ereignis.
			\end{frame}
			\note[itemize]{
				\item Linie \( L \in \mathcal{L} \) ist Transportkette.
				\item Züge aus \(L\) bedienen bestimmte Sequenzen an Stationen.
			}
		
			\begin{frame}{Fahrpläne und Vorgänge}
				Ein \emph{Fahrplan} \( \vec{\pi} = (\pi_i) \) ordnet jedem Event \( i = (L, \arr, S) \) (bzw. \( i = (L, \dep, S) \)) einen Zeitpunkt \( \pi_i \in \R \) zu.
				
				\vspace{1cm}
				Ein \emph{Vorgang} ("Activity") \( a : i \to j \) beschreibt den Übergang von \(i\) zu \(j\). Die Dauer des Vorgangs, die \emph{Spannung} ("Tension") ist
				\begin{equation*}
					x_a = \pi_j - \pi_i
				\end{equation*}
				Sei \( \mathcal{A} \) die Menge aller Vorgänge.
				
				\onslide<2->{
					\vspace{0.5cm}
					\textbf{Beispiel:} \\
					Haltevorgang \(a\) von Linie \(L\) an Station \(S\):
					\begin{equation*}
						a : (L, \dep, S) \to (L, \arr, S)
					\end{equation*}
				}
			\end{frame}
			\note[itemize]{
				\item Zeitpunkt \( \pi_i \) ist Zeitpunkt, an dem das Ereignis stattfindet.
			}
		
			\begin{frame}{Zeiteinschränkungen und Zulässigkeit}
				Jedem Vorgang \( a \in \mathcal{A} \) wird eine \emph{zulässige Dauer}
				\begin{equation*}
					\Delta_a = [l_a, u_a]
				\end{equation*}
				zugeordnet.
				
				\vspace{1cm}
				Ein Fahrplan \(\vec{\pi}\) heißt \emph{zulässig} ("feasible"), wenn gilt:
				\begin{gather*}
					\forall a \in \mathcal{A} : x_a \in \Delta_a \quad\iff\quad \forall (a : i \to j) \in \mathcal{A} : l_a \leq \pi_j - \pi_i \leq u_a
				\end{gather*}
			\end{frame}
			\note[itemize]{
				\item \(l_a\) untere und \(u_a\) obere Schranke.
			}
		
			\begin{frame}{Aussagekraft von Zeiteinschränkungen}
				\begin{itemize}
					\item Fast alle realen Einschränkungen können durch Zeitspannen beschrieben werden.
					\begin{itemize}
						\item<2-> Fahrzeit eines Zuges
						\item<2-> Sicherheitseinschränkungen (\zB Vorfahrt)
						\item<2-> Wartezeiten (Kundenzufriedenheit)
						\item<2-> Umsteigezeiten
						\item<2-> \dots
					\end{itemize}
				\end{itemize}
			\end{frame}
		
			\begin{frame}{Ereignisnetzwerk}
				\vspace{-0.35cm}
				\begin{figure}[H]
					\centering
					\begin{tikzpicture}[event/.style = { draw, rectangle, rounded corners, minimum width = 2cm, minimum height = 0.6cm }]
						\node [event]                                         (L1-dep-B) {\((L_1, \dep, B)\)};
						\node [event, above left = of L1-dep-B, xshift = 1cm] (L1-arr-C) {\((L_1, \arr, C)\)};
						\node [event, below = of L1-dep-B]                    (L1-arr-B) {\((L_1, \arr, B)\)};
						\node [event, below left = of L1-arr-B, xshift = 1cm] (L1-dep-A) {\((L_1, \dep, A)\)};
						
						\node [event, right = of L1-dep-B, xshift = 2cm]        (L2-arr-B) {\((L_2, \arr, B)\)};
						\node [event, above right = of L2-arr-B, xshift = -1cm] (L2-dep-E) {\((L_2, \dep, E)\)};
						\node [event, below = of L2-arr-B]                      (L2-dep-B) {\((L_2, \dep, B)\)};
						\node [event, below right = of L2-dep-B, xshift = -1cm] (L2-arr-D) {\((L_2, \dep, D)\)};
						
						\draw [->] (L1-dep-A) -- node[above left]{run arc} (L1-arr-B);
						\draw [->] (L1-arr-B) -- node[left]{stop arc}      (L1-dep-B);
						\draw [->] (L1-dep-B) -- node[below left]{run arc} (L1-arr-C);
						
						\draw [->] (L2-dep-E) -- node[below right]{run arc} (L2-arr-B);
						\draw [->] (L2-arr-B) -- node[right]{stop arc}      (L2-dep-B);
						\draw [->] (L2-dep-B) -- node[above right]{run arc} (L2-arr-D);
						
						\draw [->] (L2-arr-B) -- node[midway, sloped, above, yshift = -0.1cm]{change arc} (L1-dep-B);
						\draw [->] (L1-arr-B) -- node[midway, sloped, below]{change arc}                  (L2-dep-B);
						
						\draw [->] (L1-dep-B) -- node[midway, sloped, above, yshift = -0.1cm]{headway arc} (L2-dep-B);
					\end{tikzpicture}
					\caption{Ereignisnetzwerk, vgl. \cite[Fig.~1]{nachtigallSolvingPeriodicTimetable2008}}
					\label{fig:event_activity_network}
				\end{figure}
			\end{frame}
			\note[itemize]{
				\item "headway" = Vorfahrt
			}
		% end
		
		\subsection{Taktfahrpläne}
			\begin{frame}{Problematiken}
				\begin{itemize}
					\item Nicht-periodische Optimierungsprobleme \(\to\) Kürzester-Pfad-Berechnungen.
					\item Taktfahrpläne \(\to\) dieses einfache Modell funktioniert nicht mehr.
						\begin{itemize}
							\item Es ist a-priori nicht klar, in welcher Sequenz Züge ankommen.
							\item Erst nach Ordnung bekannt.
						\end{itemize}
				\end{itemize}
			\end{frame}
		
			\begin{frame}{Taktfahrpläne und periodische Zulässigkeit}
				Ein Taktfahrplan \( \vec{\pi} = (\pi_i) \) ordnet jedem periodischem Ereignis \( i \) einen \emph{Ereigniszeitpunkt} \( \pi_i \in \R \) zu. Ereignisse finden zu den Zeitpunkten \( \pi_i + z_i T \) mit dem Modulo-Parameter \(z_i \in \Z\) und der Taktzeit \(T\) statt.
			
				\vspace{1cm}
				Ein Taktfahrplan \( \vec{\pi} \) heißt \emph{zulässig} ("feasible"), wenn gilt:
				\begin{equation*}
					\forall (a : i \to j) \in \mathcal{A} : \exists z_a \in \Z : l_a \leq \pi_j - \pi_i - z_a T \leq u_a
				\end{equation*}
			\end{frame}
			\note[itemize]{
				\item Eine Periode \(T\) für alles. Unterschiedliche Perioden \(\to\) kleinstes gemeinsames Vielfache.
				\item Ein Event mehrmals in einer Periode \(\to\) Darstellen durch mehrere Events (z.B. S3-1 um +3 und S3-2 um +33).
				\item \(l_a\) und \(u_a\) wir vorher.
			}
		
			\begin{frame}{Modulo-Operator und Slack-Zeiten}
				Sei
				\begin{equation*}
					[t]_T \coloneqq \min \big\{\, t + zT \,\vert\, t + zT \geq 0, \quad z \in \Z, \quad T = \const \,\big\}
				\end{equation*}
				Es gilt offensichtlich \( 0 \leq [t]_T < T \).
			
				\vspace{1cm}
				Die untere und obere \emph{Slack-Zeit} misst, um wie viel Zeit die Spannung \( x_a = \pi_j - \pi_i \) verändert werden darf.
				\begin{align*}
					y_a^\mathit{low} &\coloneqq [x_a - l_a]_T \\
					y_a^\mathit{upp} &\coloneqq [u_a - x_a]_T
				\end{align*}
			\end{frame}
		
			\begin{frame}{Das Optimierungsproblem (Potential-Modell)}
				\begin{itemize}
					\item Durch Umkehrung einer Kante \(a\) können obere und untere Pufferzeit ausgetauscht werden.
					\item O.B.d.A. kann das Problem nur in Bezug auf \( y_a^\mathit{low} \) definiert werden.
				\end{itemize}
				
				\vspace{0.5cm}
				\( \to \) \, Gemischt-Ganzzahliges Programm ("mixed-integer program"):
				\begin{equation*}
					\min \Bigg\{\, \sum_{a \in \mathcal{A}} \omega_a (x_a - l_a - z_a T) \,\bigg\vert\, \forall a \in \mathcal{A} : l_a \leq x_a - z_a T \leq u_a, \quad z_a \in \Z \,\Bigg\}
				\end{equation*}
			\end{frame}
			\note[itemize]{
				\item \( \omega_a \) sind die Kantengewichte.
				\item Minimiere die Gewichtete untere Slack-Zeit, Vorausgesetzt der entsprechende Fahrplan ist gültig.
				\item NP-Schwer
			}
		% end
		
		% TODO: Rückblick und wichtigste Konzepte.
	% end
	
	\section{Das Slack-Modell} % TODO: Title.
		\subsection{Grundlagen von Flussnetzwerken}
			\begin{frame}{Gerichtete Graphen}
				\begin{figure}
					\centering
					\exampleDirectedGraph
					\caption{Gerichteter Graph mit \( n = 4 \) Kanten und \( m = 4 \) Knoten (laufendes Beispiel)}
					\label{fig:directed_graph}
				\end{figure}
			
				Notation: Die Kante \( a : A \to B \) geht von Knoten \(A\) zu Knoten \(B\).
			\end{frame}
		
			\begin{frame}{Spannbaum und Komplement-Baum (Ko-Baum)}
				\begin{figure}
					\centering
					\begin{minipage}{0.3\textwidth}
						\begin{tikzpicture}[node/.style = { draw, rectangle, rounded corners, minimum width = 1cm, minimum height = 0.6cm }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }]
							\node [node] (a) {\(A\)};
							\node [node, right = of a] (b) {\(B\)};
							\node [node, below = of a] (c) {\(C\)};
							\node [node, below = of b] (d) {\(D\)};
							
							\draw [co] (a) -- node[midway, sloped, above]{\(a\)} (b);
							\draw [spanning] (a) -- node[left]{\(b\)} (c);
							\draw [spanning] (d) -- node[midway, sloped, above]{\(c\)} (a);
							\draw [spanning] (b) -- node[right]{\(d\)} (d);
							\draw [co] (c) -- node[midway, sloped, above]{\(e\)} (d);
						\end{tikzpicture}
					\end{minipage}%
					\begin{minipage}{0.3\textwidth}
						\begin{tikzpicture}[node/.style = { draw, rectangle, rounded corners, minimum width = 1cm, minimum height = 0.6cm }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }]
							\node [node] (a) {\(A\)};
							\node [node, right = of a] (b) {\(B\)};
							\node [node, below = of a] (c) {\(C\)};
							\node [node, below = of b] (d) {\(D\)};
							
							\draw [spanning] (a) -- node[midway, sloped, above]{\(a\)} (b);
							\draw [spanning] (a) -- node[left]{\(b\)} (c);
							\draw [spanning] (d) -- node[midway, sloped, above]{\(c\)} (a);
							\draw [co] (b) -- node[right]{\(d\)} (d);
							\draw [co] (c) -- node[midway, sloped, above]{\(e\)} (d);
						\end{tikzpicture}
					\end{minipage}
					\null\vspace{0.5cm}
					\begin{minipage}{0.3\textwidth}
						\begin{tikzpicture}[node/.style = { draw, rectangle, rounded corners, minimum width = 1cm, minimum height = 0.6cm }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }]
							\node [node] (a) {\(A\)};
							\node [node, right = of a] (b) {\(B\)};
							\node [node, below = of a] (c) {\(C\)};
							\node [node, below = of b] (d) {\(D\)};
							
							\draw [co] (a) -- node[midway, sloped, above]{\(a\)} (b);
							\draw [co] (a) -- node[left]{\(b\)} (c);
							\draw [spanning] (d) -- node[midway, sloped, above]{\(c\)} (a);
							\draw [spanning] (b) -- node[right]{\(d\)} (d);
							\draw [spanning] (c) -- node[midway, sloped, above]{\(e\)} (d);
						\end{tikzpicture}
					\end{minipage}%
					\begin{minipage}{0.3\textwidth}
						\exampleSpanningTree
					\end{minipage}
					\caption{Mehrere (nicht alle) {\color{tud9b} Spannbäume} (rot) und {\color{tud2b} Ko-Bäume} (blau)}
				\end{figure}
			\end{frame}
	
			\begin{frame}{Inzidenzmatrix}
				Die \emph{Inzidenzmatrix} eines Netzwerks mit \(n\) Knoten und \(m\) Kanten ist eine \( n \times m \)-Matrix \( \mat{\Theta} = \theta_{ia} \):
				\begin{equation*}
					\theta_{ia} \coloneqq
						\begin{cases*}
							1  & falls \( a : j \to i \) \\
							-1 & falls \( a : i \to j \) \\
							0  & sonst
						\end{cases*}
				\end{equation*}
				
				\onslide<2->{
					\textbf{Beispiel:} \\
					\begin{minipage}[l]{0.7\textwidth}
						\begin{equation*}
							\mat{\Theta} = \kbordermatrix{
								  & a  & b  & c  & d  & e  \\
								A & 1  & -1 & 1  & 0  & 0  \\
								B & -1 & 0  & 0  & -1 & 0  \\
								C & 0  & 1  & 0  & 0  & -1 \\
								D & 0  & 0  & -1 & 1  & 1
							}
						\end{equation*}
					\end{minipage}
					\begin{minipage}[r]{0.2\textwidth}
						\exampleDirectedGraph
					\end{minipage}
				}
			\end{frame}
			\note[itemize]{
				\item Eine Zeile pro Knoten, eine Spalte pro Kante.
				\item \( a : i \to j \): Die Kante \(a\) geht von Knoten \(i\) aus.
			}

			\begin{frame}{Netzwerkmatrix ("Edge-Cycle-Matrix")}
				Durch Hinzufügen einer Ko-Baum-Kante zum Baum \(\mathcal{T}\) wird ein eindeutiger Zyklus \(c\) definiert. Sei \( \mat{\Gamma} = (\gamma_{ca}) \) die \emph{Netzwerkmatrix}:
				\begin{equation*}
					\gamma_{ca} \coloneqq
						\begin{cases*}
							1  & falls der Zyklus \(c\) die Kante \(a\) in positiver Richtung enthält \\
							-1 & falls der Zyklus \(c\) die Kante \(a\) in negativer Richtung enthält \\
							0  & sonst
						\end{cases*}
				\end{equation*}
				
				\onslide<2->{
					\textbf{Beispiel:} \\
					\begin{minipage}[l]{0.7\textwidth}
						\begin{equation*}
							\mat{\Gamma} = \kbordermatrix{
								  & a  & b & c & d & e \\
								b & 0  & 1 & 1 & 0 & 1 \\
								d & -1 & 0 & 1 & 1 & 0
							}
						\end{equation*}
					\end{minipage}
					\begin{minipage}[r]{0.2\textwidth}
						\exampleDirectedSpanningTree
					\end{minipage}
				}
			\end{frame}
			\note[itemize]{
				\item Eine Zeile pro Zyklus, eine Spalte pro Kante.
				\item Positiv heißt links herum, negativ rechts herum.
				\item Die Richtung des Zyklus ist durch die fehlende Kante definiert!
				\item Erste Zeile ist Zyklus durch \(b\), zweite durch \(d\).
			}
		
			\begin{frame}{Potential und Spannung}
				Ein \emph{Potential} \( \vec{\pi} = (\pi_i) \) ordnet jedem Knoten \(i\) einen Wert \(\pi_i \in \R\) zu.
				
				\vspace{0.5cm}
				Die Potentialdifferenz \( x_a \coloneqq \pi_j - \pi_i \) sei die \emph{Spannung} von Kante \( a : i \to j \). Es gilt \( \mat{\Theta}^T \vec{\pi} = \vec{x} \). Weiterhin ist \( \vec{x} \) eine periodische Spannung gdw. \( \mat{\Gamma} \vec{x} \equiv_T \vec{0} \) gilt.
				
				\vspace{0.5cm}
				\onslide<2->{
					\textbf{Beispiel:} \\
					\vspace{-0.5cm}
					\begin{align*}
						\vec{\pi} &= \begin{bmatrix} \pi_A & \pi_B & \pi_C & \pi_D \end{bmatrix}^T \in \R^4 \\
						\vec{x} &=
							\begin{bmatrix}
								x_a \\
								x_b \\
								x_c \\
								x_d \\
								x_e
							\end{bmatrix}
						\coloneqq
							\begin{bmatrix}
								\pi_A - \pi_B \\
								\pi_C - \pi_A \\
								\pi_A - \pi_D \\
								\pi_D - \pi_B \\
								\pi_D - \pi_C
							\end{bmatrix}
						=
							\underbrace{
								\begin{bmatrix}
									1  & -1 & 0  & 0  \\
									-1 & 0  & 1  & 0  \\
									1  & 0  & 0  & -1 \\
									0  & -1 & 0  & 1  \\
									0  & 0  & -1 & 1
								\end{bmatrix}
							}_{ = \, \mat{\Theta}^T }
							\cdot
							\begin{bmatrix}
								\pi_A \\
								\pi_B \\
								\pi_C \\
								\pi_D
							\end{bmatrix}
					\end{align*}
				}
			\end{frame}
			\note[itemize]{
				\item Potential \(\vec{\pi}\) ist ein Fahrplan, Namensgebung stammt aus elektronischen Netzwerken.
				\item \( \mat{\Gamma} \vec{x} \equiv_T \vec{0} \): Die Summe aller Spannungen in einem Kreis ist gleich einem Vielfachen der Taktzeit.
				\item Nicht-periodische Spannung: \(=\) statt \(\equiv_T\)
			}
		
			\begin{frame}{Potential und Spannung, Fortsetzung}
				\textbf{Beispiel:} \\
				\begin{minipage}[l]{0.7\textwidth}
					\begin{align*}
						\vec{x} &= \begin{bmatrix} x_a & x_b & x_c & x_d & x_e \end{bmatrix} \\
						\mat{\Gamma} \vec{x} &=
							\begin{bmatrix}
								0  & 1 & 1 & 0 & 1 \\
								-1 & 0 & 1 & 1 & 0
							\end{bmatrix}
							\cdot
							\begin{bmatrix}
								x_a \\
								x_b \\
								x_c \\
								x_d \\
								x_e
							\end{bmatrix}
							=
							\begin{bmatrix}
								x_b + x_c + x_d \\
								x_c + x_d - x_a
							\end{bmatrix}
					\end{align*}
				\end{minipage}
				\begin{minipage}[r]{0.2\textwidth}
					\exampleDirectedSpanningTree
				\end{minipage}
			\end{frame}
		
			\begin{frame}{Flüsse}
				Der \emph{Bedarf} \( \vec{v} = (v_i) \) (mit \( \sum_i v_i = 0 \)) ordnet jedem Knoten \(i\) einen Bedarf \( v_i \in \R \) zu. Ein Knoten mit \( v_i \) heißt
				\begin{equation*}
					\begin{cases*}
						\text{\emph{Quellknoten}}      & für \( v_i > 0 \) \\
						\text{\emph{Zielknoten}}       & für \( v_i < 0 \) \\
						\text{\emph{Durchgangsknoten}} & für \( v_i = 0 \)
					\end{cases*}
				\end{equation*}
				
				\vspace{1cm}
				Ein Fluss \( \vec{\varphi} = (\varphi_a) \) (mit \( \mat{\Theta} \vec{\varphi} = \vec{v} \)) ordnet jeder Kante \(a\) einen Flusswert \( \varphi_a \in \R \) zu.
			\end{frame}
			\note[itemize]{
				\item Die Flussgleichung beschreibt, dass in jedem Knoten die Zu- und Abflussmenge gleich der Nachfrage, bzw. dem Angebot, sein muss.
			}
		
			\begin{frame}{Schnitte}
				Die Knoten eines Graphen lassen sich in zwei disjunkte Mengen \( P \) und \( \bar{P} \) zerlegen. Sei \( \vec{\eta} = (\eta_{(a : i \to j)}) \) der \emph{Schnitt} bzgl. dieser Zerlegung:
				\begin{equation*}
					\eta_{(a : i \to j)} \coloneqq
						\begin{cases*}
							1  & falls \( i \in P \) und \( j \in \bar{P} \) \\
							-1 & falls \( i \in \bar{P} \) und \( j \in P \)\\
							0  & sonst
						\end{cases*}
				\end{equation*}
				
				\onslide<2->{
					\textbf{Beispiel:} \\
					\begin{minipage}[l]{0.7\textwidth}
						\begin{align*}
							P &= \{\, \text{C} \,\} \\
							\bar{P} &= \{\, \text{A}, \text{B}, \text{D} \,\} \\
							\vec{\eta} &= \begin{bmatrix} 0 & -1 & 0 & 0 & 1 \end{bmatrix}^T \\
						\end{align*}
					\end{minipage}
					\begin{minipage}[r]{0.2\textwidth}
						\exampleDirectedSpanningTree
					\end{minipage}
				}
			\end{frame}
			\note[itemize]{
				\item Aus Sicht von \( P \): \(-1\) bei eingehenden Kanten, \(1\) bei ausgehenden.
				\item Für einen Knoten exakt das negativer der Entsprechenden Zeile in \( \mat{\Theta} \).
			}
			
			% TODO: Rückblick und wichtigste Konzepte.
		% end
		
		\subsection{Spannbaumstrukturen}
			\begin{frame}{Spannbaumstrukturen und generiertes Potential}
				Sei \( \mathcal{T} = \mathcal{T}^l + \mathcal{T}^u \) ein Spannbaum, separiert in \( \mathcal{T}^l \) und \( \mathcal{T}^u \), sodass gilt:
				\begin{equation*}
					\forall a \in \mathcal{T}^l : x_a = l_a \qquad\text{und}\qquad \forall a \in \mathcal{T}^u : x_a = u_a
				\end{equation*}
				
				\vspace{0.5cm}
				Jede Struktur bestimmt ein eindeutiges Potential \( \vec{\pi}^{(\mathcal{T})} \), für das gilt:
				\begin{align*}
					& \forall (a : i \to j) \in \mathcal{T}^l : \pi^{(\mathcal{T})}_j - \pi^{(\mathcal{T})}_i = l_a \\
					& \forall (a : i \to j) \in \mathcal{T}^l : \pi^{(\mathcal{T})}_j - \pi^{(\mathcal{T})}_i = u_a
				\end{align*}
			\end{frame}
			\note[itemize]{
				\item In \( \mathcal{T}^l \) sind alle Spannungen an der unteren Schranke, in \( \mathcal{T}^u \) an der oberen.
				\item Spannbaumstruktur \(\mathcal{T}\) durchfürbar, wenn das bestimmte Potential durchführbar ist (in Bezug auf alle Zeiteinschränkungen).
			}
		
			\begin{frame}{Das Optimierungsproblem (Slack-Modell)}
				Mit \( \vec{b} \coloneqq [-\mat{\Gamma} \vec{l}]_T \) und \( \vec{\delta} \coloneqq \vec{u} - \vec{l} \) ist die \emph{Menge zulässiger Slack-Zeiten} \(\mathcal{Y}\) definiert:
				\begin{align*}
					\mathcal{Y} \coloneqq& \,\big\{\, \vec{y} \in \Z^m \,\vert\, \mat{\Gamma} \vec{y} \equiv_T \vec{b}, \quad \vec{0} \leq \vec{y} \leq \vec{\delta} \,\big\}
					%=& \,\big\{\, \vec{y} \in \Z^m \,\vert\, \mat{\Gamma} \vec{y} \equiv_T [-\mat{\Gamma} \vec{l}]_T, \quad \vec{0} \leq \vec{y} \leq \vec{u} - \vec{l} \,\big\} \\
					%=& \,\big\{\, \vec{y} \in \Z^m \,\vert\, \mat{\Gamma} \vec{y} \equiv_T [-\mat{\Gamma} \vec{l}]_T, \quad \vec{l} \leq \vec{y} + \vec{l} \leq \vec{u} \,\big\} \\
					%=& \,\big\{\, \vec{y} \in \Z^m \,\vert\, \mat{\Gamma} \vec{y} \equiv_T -\mat{\Gamma} \vec{l}, \quad \vec{l} \leq \vec{y} + \vec{l} \leq \vec{u} \,\big\} \\
					%=& \,\big\{\, \vec{y} \in \Z^m \,\vert\, \mat{\Gamma} \vec{y} + \mat{\Gamma} \vec{l} \equiv_T \vec{0}, \quad \vec{l} \leq \vec{y} + \vec{l} \leq \vec{u} \,\big\} \\
					%=& \,\big\{\,\vec{y} \in \Z^m \,\vert\, \mat{\Gamma} (\vec{y} + \vec{l}) \equiv_T \vec{0}, \quad \vec{l} \leq \vec{y} + \vec{l} \leq \vec{u} \,\big\}
				\end{align*}
				
				\vspace{1cm}
				Das Optimierungsproblem kann wie folgt umformuliert werden:
				\begin{align*}
					& \min \big\{\, \vec{\omega}^T \vec{y} \,\vert\, \vec{y} \in \mathcal{Y} \,\big\} \\
					%=& \min \big\{\, \vec{\omega}^T \vec{y} \,\vert\, \mat{\Gamma} \vec{y} \equiv_T \vec{b}, \quad \vec{0} \leq \vec{y} \leq \vec{\delta}, \quad \vec{y} \in \Z^m \,\big\} \\
					%=& \min \big\{\, \vec{\omega}^T (\vec{x} - \vec{l}) \,\vert\, \mat{\Gamma} (\vec{x} - \vec{l}) \equiv_T \vec{b}, \quad \vec{0} \leq \vec{x} - \vec{l} \leq \vec{\delta}, \quad \vec{x} \in \Z^m \,\big\} \\
					%=& \min \big\{\, \vec{\omega}^T (\vec{x} - \vec{l}) \,\vert\, \mat{\Gamma} (\vec{x} - \vec{l}) \equiv_T -\mat{\Gamma} \vec{l}, \quad \vec{0} \leq \vec{x} - \vec{l} \leq \vec{u} - \vec{l}, \quad \vec{x} \in \Z^m \,\big\} \\
					%=& \min \big\{\, \vec{\omega}^T (\vec{x} - \vec{l}) \,\vert\, \mat{\Gamma} \vec{x} \equiv_T \vec{0}, \quad \vec{l} \leq \vec{x} \leq \vec{u}, \quad \vec{x} \in \Z^m \,\big\}
				\end{align*}
			\end{frame}
			\note[itemize]{
				\item \( \vec{x} = \vec{y} + \vec{l} \quad\iff\quad \vec{y} = \vec{x} - \vec{l} \)
			}
		% end

		\subsection{Untersuchung des Slack-Modells}
 			\begin{frame}{Dualität zum Minimum-Cost Flow Problem}
				Werden die Modulo-Parameter \(z_a\) fixiert, kann das Optimierungsproblem umformuliert werden:
				\begin{align*}
					&\, \min \Bigg\{\, \sum_{a}^{\mathcal{A}} \omega_a (x_a - l_a - z_a T) \,\bigg\vert\, \forall a \in \mathcal{A} : l_a \leq x_a - z_a T \leq u_a \,\Bigg\} \\
					=&\, \min \Bigg\{\, \sum_{a}^{\mathcal{A}} \omega_a (x_a - l_a') \,\bigg\vert\, \forall a \in \mathcal{A} : l_a' = l_a + z_a T \leq x_a \leq u_a' = u_a + z_a T \,\Bigg\} \\
					=&\, \min \big\{\, \vec{\omega}^T (\mat{\Theta}^T \vec{\pi} - \vec{l}') \,\big\vert\, \vec{l}' \leq \mat{\Theta}^T \vec{\pi} \leq \vec{u}' \,\big\}
				\end{align*}
				Dies ist die duale Formulierung des Minimum-Cost Flow Problems.
				
				Jeder Extrempunkt der gültigen Region des Problems entspricht einer Spannbaumstruktur.
			\end{frame}
			\note[itemize]{
				\item Dualität heißt, zur Betrachtung des "primalen" Problems wird ein anderes herangezogen.
				\item \(\vec{l}'\) kann aufgrund von \( \vec{z} = \const \) einfach ausgerechnet werden.
			}
		
			\begin{frame}{Periodische Basislösung}
				Sind \( \vec{z}^\mathcal{T} \) die fixierten Modulo-Parameter, so heißt
				\begin{equation*}
					\begin{bmatrix}
						\vec{\pi}^{\mathcal{T}} \\
						\vec{z}^{\mathcal{T}}
					\end{bmatrix}
				\end{equation*}
				die \emph{periodische Basislösung} in Bezug auf die Spannbaumstruktur \( \mathcal{T} \).
			\end{frame}
		
			\begin{frame}{Extrempunkte \(\quad\longleftrightarrow\quad\) Spannbaumstrukturen} % TODO: Titel!
				Sei
				\begin{equation*}
					\mathcal{Q} \coloneqq \mathit{conv.hull} \Bigg\{\, \begin{bmatrix} \vec{\pi} \\ \vec{z} \end{bmatrix} \,\bigg\vert\, \vec{l} \leq \mat{\Theta}^T \vec{\pi} - T\vec{z} \leq \vec{u}, \quad \vec{\pi} \in \R^n, \quad \vec{z} \in \Z^m \,\Bigg\}
				\end{equation*}
				der \emph{periodische Fahrplan-Polyeder}.
				
				\vspace{1cm}
				\textbf{Theorem.} Der Vektor \( \begin{bmatrix} \vec{\pi} \\ \vec{z} \end{bmatrix} \in \mathcal{Q} \) ist ein Extrempunkt von \( \mathcal{Q} \) gdw. er eine periodische Basislösung in Bezug auf eine Spannbaumstruktur ist.
			\end{frame}
			\note[itemize]{
				\item Konvexe Hülle bei Bedarf erklären.
				\item Daher werden Baumstrukturen gesucht, um den optimalen Fahrplan zu finden.
			}

% TODO
%			\begin{frame}{Theorem 22} % TODO: Titel! Und Warum...
%				\textbf{Theorem.} Es existiert eine Matrix \( \mat{F} \in \R^{m \times m} \) mit \( \mat{\Theta} \mat{F} \equiv_T \vec{0} \) und ein Vektor \( \vec{r} \in \R^m \), sodass
%				\begin{align*}
%					& \mathit{conv.hull} \big\{\, \vec{x} \in \Z^m \,\vert\, \exists \vec{z} \in \Z^m : ( \mat{\Gamma} \vec{x} - T\vec{z} = \vec{0}, \quad \vec{l} \leq \vec{x} - T\vec{z} \leq \vec{u} ) \big\} \\
%					=\,& \big\{\, \vec{x} \,\vert\, \mat{F} \vec{x} \geq \vec{r} \,\big\}
%					\intertext{oder äquivalent}
%					& \mathit{conv.hull} \big\{\, \vec{y} \in \Z^m \,\vert\, \exists \vec{z} \in \Z^m : ( \mat{\Gamma} \vec{y} - T\vec{z} = \vec{b}, \quad \vec{0} \leq \vec{y} - T\vec{z} \leq \vec{\delta} ) \big\} \\
%					=\,& \big\{\, \vec{y} \,\vert\, \mat{F} \vec{y} \geq \tilde{\vec{r}} \coloneqq \vec{r} - \mat{F} \vec{l} \,\big\}
%				\end{align*}
%				gilt.
%			\end{frame}
%			\note[itemize]{
%				\item Jede Zeile von \( \mat{F} \) ist eine Spannung.
%				\item Mit \( \vec{x} = \vec{y} + \vec{l} \quad\iff\quad \vec{y} = \vec{x} - \vec{l} \) ist die Äquivalenz klar.
%				\item Es gilt \( \vec{b} \coloneqq [-\mat{\Gamma} \vec{l}]_T \) und \( \vec{\delta} \coloneqq \vec{u} - \vec{l} \).
%			}
		
			% TODO: Ab dem Lemma fehlen die Sachen.
		% end
	% end
	
	\section{Das Modulo-Netzwerk-Simplex-Verfahren}
		\subsection{Einführung}
			\begin{frame}{Arbeits-/Erkundungsbereich}
				Die Modulo-Simplex-Methode erkundet die Extrempunkte des Optimierungsproblems
				\begin{gather*}
					\min \Big\{\, \vec{\omega}^T \vec{y} \,\big\vert\, \vec{y} \in \mathcal{Y}\coloneqq \big\{\, \vec{y} \in \Z^m \,\vert\, \exists \vec{z} \in \Z^m : ( \mat{\Gamma} \vec{y} - T\vec{z} = \vec{b}, \quad \vec{0} \leq \vec{y} - T\vec{z} \leq \vec{\delta} ) \,\big\} \Big\}
				\end{gather*}
				Das heißt des Polyeders \( \mathit{conv.hull}(\mathcal{Y}) \).
			\end{frame}
		
			\begin{frame}{Behandlung der Modulo-Parameter}
				\begin{itemize}
					\item Die Ganzzahligkeit von \(\vec{z}\) macht das Problem sehr schwer.
					\item Daher: Eliminierung von \(\vec{z}\) durch Restklassenberechnungen (Modulo-Berechnungen).
				\end{itemize}
			
				\vspace{0.5cm}
				\begin{equation*}
					\min \Big\{\, \vec{\omega}^T \vec{y} \,\big\vert\, \vec{y} \in \mathcal{Y}\coloneqq \big\{\, \vec{y} \in \Z^m \,\vert\, \exists \vec{z} \in \Z^m : ( \mat{\Gamma} \vec{y} \equiv_T \vec{b}, \quad \vec{0} \leq \vec{y} \leq \vec{\delta} ) \,\big\} \Big\}
				\end{equation*}
			\end{frame}
		% end
	
		\subsection{Simplex-Tableau}
			\begin{frame}{Idee}
				\begin{itemize}
					\item Beginnend von der Basislösung \( \begin{bmatrix} \vec{0}^T & \vec{b}^T \end{bmatrix}^T \) bewegt sich der Algorithmus auf den Kanten des Polyeders \( \mathit{conv.hull}(\mathcal{Y}) \).
					\item In jedem Schritt: Überprüfen der Verbesserung.
					\item Keine Verbesserung möglich \( \implies \) lokales Minimum gefunden.
				\end{itemize}
			\end{frame}
		
			\begin{frame}{Separierung der Netzwerkmatrix}
				Separierung der Netzwerkmatrix \( \mat{\Gamma}_\mathcal{T} = \big[ \mat{N}_\mathcal{T},\, \mat{I}_\mathcal{T}^\mathit{co} \big] \) in Baum-Kanten \( \mat{N}_\mathcal{T} \) und Ko-Baum-Kanten \( \mat{I}_\mathcal{T}^\mathit{co} \).
				
				\(\implies\) Periodische Basislösung \( \vec{y}_\mathcal{T} = \begin{bmatrix} \vec{y}_\mathcal{T} \\ \vec{y}_\mathcal{T}^\mathit{co} \end{bmatrix} = \begin{bmatrix} \vec{0} \\ \vec{b} \end{bmatrix} \)
				
				\onslide<2->{
					\vspace{0.5cm}
					\textbf{Beispiel:} \\
					\begin{minipage}[l]{0.7\textwidth}
						\begin{align*}
							\mat{\Gamma} &= \kbordermatrix{
								  & a  & b & c & d & e \\
								b & 0  & 1 & 1 & 0 & 1 \\
								d & -1 & 0 & 1 & 1 & 0
							} \\
							\implies\quad \mat{\Gamma}_\mathcal{T} &= \kbordermatrix{
								  & a  & c & e & b & d \\
								b & 0  & 1 & 1 & 1 & 0 \\
								d & -1 & 1 & 0 & 0 & 1
							}
						\end{align*}
						\vspace{0.05cm}
					\end{minipage}
					\begin{minipage}[r]{0.2\textwidth}
						\exampleDirectedSpanningTree
					\end{minipage}
				}
			\end{frame}
			\note[itemize]{
				\item \( \mat{I}_\mathcal{T}^\mathit{co} \) ist die Identitiätsmatrix.
				\item Basislösung: Der "komplizierte Teil" der Matrix verschwindet, die Identitätsmatrix wird mit der RHS multipliziert.
				\item Reihenfolge vor Separierung: a, b, c, d, e
				\item Reihenfolge nach Separierung: a, c, e, b, d
				\item Die Subskripte \( _\mathcal{T} \) werden in Zukunft weggelassen.
			}
		
			\begin{frame}{Aufstellung des Tableau}
				Seien \( a_1, \cdots, a_{r - 1} \) die Ko-Baum-Kanten und \( a_r, \cdots, a_m \) die Baum-Kanten.
			
				Formulierung als Simplex-Tableau:
				\begin{equation*}
					\left[\!\begin{array}{ccc||c}
						\mat{N} & \mat{I} & \vec{b} & \vec{\omega}
					\end{array}\!\right]
				\end{equation*}
				\begin{equation*}
					\begin{array}{c|cc|ccc|c||c}
						       &     a_1     & \cdots & a_r & \cdots & a_m &        &          \\ \hline
						 a_r   & \gamma_{r1} & \cdots &  1  &        &  0  &  b_r   & \omega_r \\
						\vdots &   \vdots    & \ddots &     & \ddots &     & \vdots &  \vdots  \\
						 a_m   & \gamma_{m1} & \cdots &  0  &        &  1  &  b_m   & \omega_m \\ \hline
						       &             &        &     &        &     &        &  \omega
					\end{array}
				\end{equation*}
			\end{frame}
		
			\begin{frame}{Basis-Austausch, Teil 1}
				Auswahl eines Pivot-Elements \( a_{ij} \):
				\begin{equation*}
					\begin{array}{c|cccc|ccccc|c||c}
						       &     a_1     & \cdots &            a_j             & \cdots &  a_r   & \cdots & a_i & \cdots &  a_m   &        &          \\ \hline
						 a_r   & \gamma_{r1} & \cdots &        \gamma_{rj}         & \cdots &   1    & \cdots &  0  & \cdots &   0    &  b_r   & \omega_r \\
						\vdots &   \vdots    & \ddots &           \vdots           & \ddots & \vdots & \ddots &     & \ddots & \vdots & \vdots &  \vdots  \\
						 a_i   & \gamma_{i1} & \cdots & \framebox{\(\gamma_{ij}\)} & \cdots &   0    &        &  1  &        &   0    &  b_i   & \omega_i \\
						\vdots &   \vdots    & \ddots &           \vdots           & \ddots & \vdots & \ddots &     & \ddots & \vdots & \vdots &  \vdots  \\
						 a_m   & \gamma_{m1} & \cdots &        \gamma_{mj}         & \cdots &   0    & \cdots &  0  & \cdots &   1    &  b_m   & \omega_m \\ \hline
						       &             &        &                            &        &        &        &     &        &        &        &  \omega
					\end{array}
				\end{equation*}
			\end{frame}
			\note[itemize]{
				\item Auswahlverfahren kommt später.
			}
		
			\begin{frame}{Basis-Austausch, Teil 2}
				\vspace{-0.3cm}
				Austausch von \( z_i \) mit \( x_j \):
				\begin{table}[H]
					\centering
					\begin{tabular}{lll}
						Pivotelement:                        & \( \gamma_{ij} = \frac{1}{\gamma_{ij}} \)                                     &                                                                      \\
						Pivotzeile für alle \( s \neq j \):  & \( \gamma_{is} = \frac{\gamma_{is}}{\gamma_{ij}} \)                           & \( b_r = \left[\frac{b_r}{\gamma_{ij}}\right]_T \)                   \\
						Pivotspalte für alle \( r \neq i \): & \( \gamma_{rj} = -\frac{\gamma_{rj}}{\gamma_{ij}} \)                          &                                                                      \\
						Restliche Elemente des Tableaus:     & \( \gamma_{rs} = \gamma_{rs} - \frac{\gamma_{is} \gamma_{rj}}{\gamma_{ij}} \) & \( b_r = \left[b_r - \frac{\gamma_{rj}}{\gamma_{ij}} b_i\right]_T \)
					\end{tabular}
				\end{table}
				
				\onslide<2->{
					\vspace{-0.3cm}
					\scriptsize
					\begin{equation*}
						\begin{array}{c|cccc|ccccc|c||c}
       &                  a_1                  & \cdots &          a_i           & \cdots &  a_r   & \cdots & a_j & \cdots &  a_m   &                                 &          \\ \hline
 a_r   & \gamma_{r1} - \frac{\gamma_{i1} \gamma_{rj}}{\gamma_{ij}} & \cdots & -\frac{\gamma_{rj}}{\gamma_{ij}} & \cdots &   1    & \cdots &  0  & \cdots &   0    & \left[b_r - \frac{\gamma_{rj}}{\gamma_{ij}} b_i\right]_T & \omega_r \\
\vdots &                \vdots                 & \ddots &         \vdots         & \ddots & \vdots & \ddots &     & \ddots & \vdots &             \vdots              &  \vdots  \\
 a_j   &         \frac{\gamma_{i1}}{\gamma_{ij}}         & \cdots &    \frac{1}{\gamma_{ij}}    & \cdots &   0    &        &  1  &        &   0    &       \left[\frac{b_i}{\gamma_{ij}}\right]_T        & \omega_j \\
\vdots &                \vdots                 & \ddots &         \vdots         & \ddots & \vdots & \ddots &     & \ddots & \vdots &             \vdots              &  \vdots  \\
 a_m   & \gamma_{m1} - \frac{\gamma_{i1} \gamma_{mj}}{\gamma_{ij}} & \cdots & -\frac{\gamma_{mj}}{\gamma_{ij}} & \cdots &   0    & \cdots &  0  & \cdots &   1    & \left[b_m - \frac{\gamma_{mj}}{\gamma_{ij}} b_m\right]_T & \omega_m \\ \hline
       &                                       &        &                        &         &        &        &     &        &        &                                 &  \omega
						\end{array}
					\end{equation*}
				}
			\end{frame}
		
			\begin{frame}{Kostenänderung}
				Kosten vor (\(\omega\)) und nach (\( \tilde{\omega}_{ij} \)) der Vertauschung von \( a_i \) und \( a_j \):
				\begin{equation*}
					\omega = \sum_{k = r}^{m} \omega_k b_k \quad\quad\quad\quad \tilde{\omega}_{ij} = \omega_j \bigg[ \frac{b_i}{\gamma_{ij}} \bigg]_T \! + \sum_{\substack{k = r \\ k \neq i}}^{m} \omega_k \bigg[ b_k - \frac{\gamma_{kj}}{\gamma_{ij}} b_i \bigg]_T
				\end{equation*}
				Kostenänderung:
				\begin{align*}
					\Delta\omega_{ij} &= \tilde{\omega}_{ij} - \omega \\
					&= \omega_j \bigg[ \frac{b_i}{\gamma_{ij}} \bigg]_T \! - \omega_i b_i + \sum_{\substack{k = r \\ k \neq i}}^{m} \omega_k \Bigg( \bigg[ b_k - \frac{\gamma_{kj}}{\gamma_{ij}} b_i \bigg]_T - b_k \Bigg)
				\end{align*}
			\end{frame}
		
			\begin{frame}{Auswahl des Pivotelements}
				\begin{itemize}
					\item Berechnung aller Kostenänderungen.
					\item Nur für Austausche, die einen Spannbaum beibehalten!
					\item Andere Austausche führen zur Division durch Null.
					\item Ist keine negative (verbessernde) Änderung möglich \( \implies \) Abbruch.
				\end{itemize}
			\end{frame}
		
			\begin{frame}{Beispiel (vgl.~\cite{nachtigallSolvingPeriodicTimetable2008})}
				\vspace{-0.4cm}
				\begin{minipage}{0.5\textwidth}
					\begin{figure}
						\centering
						\begin{tikzpicture}[event/.style = { draw, circle }, anchor = center]
							\node [event] (A) at (-2.3, -2.5) {\(A\)};
							\node [event] (B) at (0, 0) {\(B\)};
							\node [event] (C) at (-2.3, 2.5) {\(C\)};
							\node [event] (D) at (2.5, 0) {\(D\)};
							
							\draw [->] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_1, [9, 28] \)} (A);
							\draw [->] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_2, [7, 26] \)} (C);
							\draw [->] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_3, [2, 21] \)} (A);
							\draw [->] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_4, [1, 20] \)} (D);
							\draw [->] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_5, [5, 24] \)} (C);
							\draw [->] (A) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_6, [3, 22] \)} (C);
						\end{tikzpicture}
						\caption{Ereignisnetzwerk}
					\end{figure}
				\end{minipage}%
				\begin{minipage}{0.5\textwidth}
					\begin{table}
						\centering
						\begin{tabular}{c|cc}
							\(a_i\) & \(\Delta_i = [l_i, u_i]\) & \(\omega_i\) \\ \hline
							\(a_1\) &       \( [9, 28] \)       &    \(8\)     \\
							\(a_2\) &       \( [7, 26] \)       &    \(3\)     \\
							\(a_3\) &       \( [2, 21] \)       &    \(5\)     \\
							\(a_4\) &       \( [1, 20] \)       &    \(9\)     \\
							\(a_5\) &       \( [5, 24] \)       &    \(1\)     \\
							\(a_6\) &       \( [3, 22] \)       &    \(4\)
						\end{tabular}
					\end{table}
					\begin{equation*}
						T = 20
					\end{equation*}
				\end{minipage}
			\end{frame}
		
			\begin{frame}{Beispiel, Bestimmung einer Spannbaumstruktur}
				\vspace{-0.4cm}
				\begin{minipage}{0.5\textwidth}
					\begin{figure}
						\centering
						\begin{tikzpicture}[event/.style = { draw, circle }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }, anchor = center]
							\node [event] (A) at (-2.3, -2.5) {\(A\)};
							\node [event] (B) at (0, 0) {\(B\)};
							\node [event] (C) at (-2.3, 2.5) {\(C\)};
							\node [event] (D) at (2.5, 0) {\(D\)};
							
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_1, [9, 28] \)} (A);
							\draw [->, spanning] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_2, [7, 26] \)} (C);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_3, [2, 21] \)} (A);
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_4, [1, 20] \)} (D);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_5, [5, 24] \)} (C);
							\draw [->, co]       (A) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_6, [3, 22] \)} (C);
						\end{tikzpicture}
						\caption{{ \color{tud9b} Spannbaum} und { \color{tud2b} Ko-Baum }}
					\end{figure}
				\end{minipage}%
				\begin{minipage}{0.5\textwidth}
					\begin{equation*}
						\mat{\Gamma} = \kbordermatrix{
							& a_2 & a_3 & a_5 & a_4 & a_1 & a_6 \\
							a_4 & -1 & 0 & 1 & 1 & 0 & 0 \\
							a_1 & -1 & -1 & 1 & 0 & 1 & 0 \\
							a_6 & 0 & 1 & -1 & 0 & 0 & 1
						}
					\end{equation*}
				\end{minipage}
			\end{frame}
		
			\begin{frame}{Beispiel, Bestimmung der Basislösung}
				\vspace{-0.4cm}
				\begin{minipage}{0.5\textwidth}
					\begin{figure}
						\centering
						\begin{tikzpicture}[event/.style = { draw, circle }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }, anchor = center]
							\node [event, label = below:{ \( \onslide<5->{\pi_A = 4} \) }] (A) at (-2.3, -2.5) {\(A\)};
							\node [event, label =  left:{ \( \onslide<2->{\pi_B = 0} \) }] (B) at (0, 0) {\(B\)};
							\node [event, label = right:{ \( \onslide<3->{\pi_C = 7} \) }] (C) at (-2.3, 2.5) {\(C\)};
							\node [event, label = below:{ \( \onslide<4->{\pi_D = 2} \) }] (D) at (2.5, 0) {\(D\)};
							
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_1, [9, 28] \)} (A);
							\draw [->, spanning] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_2, [7, 26] \)} (C);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_3, [2, 21] \)} (A);
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_4, [1, 20] \)} (D);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_5, [5, 24] \)} (C);
							\draw [->, co]       (A) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_6, [3, 22] \)} (C);
						\end{tikzpicture}
					\end{figure}
				\end{minipage}%
				\begin{minipage}{0.5\textwidth}
					\begin{equation*}
						\vec{b} = \big[ \! -\mat{\Gamma} \vec{l} \big]_T =
							\begin{bmatrix}
								1 \\
								15 \\
								0
							\end{bmatrix}
					\end{equation*}
					\vspace{-0.4cm}
					\begin{table}
						\centering
						\begin{tabular}{c|cc|c}
							\(a_i\) & \(\Delta_i = [l_i, u_i]\) & \(\omega_i\) & \(y_i\) \\ \hline
							\(a_1\) &       \( [9, 28] \)       &    \(8\)     & \(15\)  \\
							\(a_2\) &       \( [7, 26] \)       &    \(3\)     &  \(0\)  \\
							\(a_3\) &       \( [2, 21] \)       &    \(5\)     &  \(0\)  \\
							\(a_4\) &       \( [1, 20] \)       &    \(9\)     &  \(1\)  \\
							\(a_5\) &       \( [5, 24] \)       &    \(1\)     &  \(0\)  \\
							\(a_6\) &       \( [3, 22] \)       &    \(4\)     &  \(0\)
						\end{tabular}
					\end{table}
				\end{minipage}
			\end{frame}
			\note[itemize]{
				\item Beispielhafte Bestimmung von \(\vec{\pi}\)! Angefangen von \( \pi_B = 0 \) rekursiv weiter.
			}
		
			\begin{frame}{Beispiel, Darstellung im Tableau und Kostenänderung}
				Initiales Simplex-Tableau:
				\begin{equation*}
					\begin{array}{c|ccc|ccc|c||c}
						    & a_2 & a_3 & a_5 & a_4 & a_1 & a_6 & b  & \omega \\ \hline
						a_4 & -1  &  0  &  1  &  1  &  0  &  0  & 1  &   9    \\
						a_1 & -1  & -1  &  1  &  0  &  1  &  1  & 15 &   8    \\
						a_6 &  0  &  1  & -1  &  0  &  0  &  1  & 0  &   4    \\ \hline
						    &     &     &     &     &     &     &    &  129
					\end{array}
				\end{equation*}
				
				Kostenänderung für verschiedene Austausche:
				\begin{equation*}
					\begin{array}{c|ccc}
						    &        a_2         & a_3 & a_5 \\ \hline
						a_4 &         40         &  -  & -12 \\
						a_1 & \framebox{\(-60\)} & -35 &  0  \\
						a_6 &         -          &  0  &  0
					\end{array}
				\end{equation*}
			\end{frame}
		
			\begin{frame}{Beispiel, Basis-Austausch}
				Austausch von Ko-Baum-Kante \( a_1 \) mit Baum-Kante \( a_2 \):
				\begin{align*}
					&\begin{array}{c|ccc|ccc|c||c}
						    & a_2 & a_3 & a_5 & a_4 & a_1 & a_6 & b  & \omega \\ \hline
						a_4 & -1  &  0  &  1  &  1  &  0  &  0  & 1  &   9    \\
						a_1 & -1  & -1  &  1  &  0  &  1  &  1  & 15 &   8    \\
						a_6 &  0  &  1  & -1  &  0  &  0  &  1  & 0  &   4    \\ \hline
						    &     &     &     &     &     &     &    &  129
					\end{array} \\
					\leadsto\quad\quad&
					\begin{array}{c|ccc|ccc|c||c}
						    & a_1 & a_3 & a_5 & a_4 & a_2 & a_6 & b & \omega \\ \hline
						a_4 & -1  &  1  &  0  &  1  &  0  &  0  & 6 &   9    \\
						a_2 & -1  &  1  & -1  &  0  &  1  &  0  & 5 &   3    \\
						a_6 &  0  &  1  & -1  &  0  &  0  &  1  & 0 &   4    \\ \hline
						    &     &     &     &     &     &     &   &   69
					\end{array}
				\end{align*}
			\end{frame}
		
			\begin{frame}{Beispiel, Spannbaum vor und nach Austausch}
				\vspace{-0.4cm}
				\begin{minipage}{0.5\textwidth}
					\begin{figure}
						\centering
						\begin{tikzpicture}[event/.style = { draw, circle }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }, anchor = center]
							\node [event, label = below:{ \( \pi_A = 4 \) }] (A) at (-2.3, -2.5) {\(A\)};
							\node [event, label =  left:{ \( \pi_B = 0 \) }] (B) at (0, 0) {\(B\)};
							\node [event, label = right:{ \( \pi_C = 7 \) }] (C) at (-2.3, 2.5) {\(C\)};
							\node [event, label = below:{ \( \pi_D = 2 \) }] (D) at (2.5, 0) {\(D\)};
							
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_1, [9, 28] \)} (A);
							\draw [->, spanning] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_2, [7, 26] \)} (C);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_3, [2, 21] \)} (A);
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_4, [1, 20] \)} (D);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_5, [5, 24] \)} (C);
							\draw [->, co]       (A) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_6, [3, 22] \)} (C);
						\end{tikzpicture}
					\end{figure}
				\end{minipage}%
				\begin{minipage}{0.5\textwidth}
					\begin{figure}
						\centering
						\begin{tikzpicture}[event/.style = { draw, circle }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }, anchor = center]
							\node [event, label = below:{ \( \pi_A = 9 \) }] (A) at (-2.3, -2.5) {\(A\)};
							\node [event, label =  left:{ \( \pi_B = 0 \) }] (B) at (0, 0) {\(B\)};
							\node [event, label = right:{ \( \pi_C = 12 \) }] (C) at (-2.3, 2.5) {\(C\)};
							\node [event, label = below:{ \( \pi_D = 7 \) }] (D) at (2.5, 0) {\(D\)};
							
							\draw [->, spanning] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_1, [9, 28] \)} (A);
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_2, [7, 26] \)} (C);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_3, [2, 21] \)} (A);
							\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_4, [1, 20] \)} (D);
							\draw [->, spanning] (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_5, [5, 24] \)} (C);
							\draw [->, co]       (A) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_6, [3, 22] \)} (C);
						\end{tikzpicture}
					\end{figure}
				\end{minipage}%
			\end{frame}
		
			\begin{frame}{Beispiel, Iteration 2}
				Simplex-Tableau nach Iteration 1:
				\begin{equation*}
					\begin{array}{c|ccc|ccc|c||c}
						    & a_1 & a_3 & a_5 & a_4 & a_2 & a_6 & b & \omega \\ \hline
						a_4 & -1  &  1  &  0  &  1  &  0  &  0  & 6 &   9    \\
						a_2 & -1  &  1  & -1  &  0  &  1  &  0  & 5 &   3    \\
						a_6 &  0  &  1  & -1  &  0  &  0  &  1  & 0 &   4    \\ \hline
						    &     &     &     &     &     &     &   &   69
					\end{array}
				\end{equation*}
				
				Kostenänderung für verschiedene Austausche:
				\begin{equation*}
					\begin{array}{c|ccc}
						    & a_1 & a_3 & a_5 \\ \hline
						a_4 & 100 & 74  &  -  \\
						a_2 & 60  & 25  & 60  \\
						a_6 &  -  &  0  &  0
					\end{array}
				\end{equation*}
				\(\implies\) Keine weitere Verbesserung möglich. Abbruch.
			\end{frame}
		
			\begin{frame}{Beispiel, Bewertung des Ergebnisses}
				Endergebnis:
				\begin{equation*}
					\begin{array}{c|ccc|ccc|c||c}
						    & a_1 & a_3 & a_5 & a_4 & a_2 & a_6 & b & \omega \\ \hline
						a_4 & -1  &  1  &  0  &  1  &  0  &  0  & 6 &   9    \\
						a_2 & -1  &  1  & -1  &  0  &  1  &  0  & 5 &   3    \\
						a_6 &  0  &  1  & -1  &  0  &  0  &  1  & 0 &   4    \\ \hline
						    &     &     &     &     &     &     &   &   69
					\end{array}
				\end{equation*}
				
				Aber der Spannbaum \( \mathcal{T} = \{\, a_4, a_1, a_6 \,\} \) mit Tableau
				\begin{equation*}
					\begin{array}{c|ccc|ccc|c||c}
						    & a_6 & a_1 & a_4 & a_2 & a_3 & a_5 & b & \omega \\ \hline
						a_2 & -1  & -1  &  0  &  1  &  0  &  0  & 5 &   3    \\
						a_3 &  0  & -1  &  1  &  0  &  1  &  0  & 6 &   5    \\
						a_5 & -1  & -1  &  1  &  0  &  0  &  1  & 6 &   1    \\ \hline
						    &     &     &     &     &     &     &   &   51
					\end{array}
				\end{equation*}
				liefert ein besseres Ergebnis.
			\end{frame}
		
%			\begin{frame}
%				\vspace{-0.4cm}
%				\begin{figure}
%					\centering
%					\begin{tikzpicture}[event/.style = { draw, circle }, spanning/.style = { draw = tud9b }, co/.style = { draw = tud2b }, anchor = center]
%						\node [event, label = below:{ \( \pi_A = 9 \) }] (A) at (-2.3, -2.5) {\(A\)};
%						\node [event, label =  left:{ \( \pi_B = 0 \) }] (B) at (0, 0) {\(B\)};
%						\node [event, label = right:{ \( \pi_C = 12 \) }] (C) at (-2.3, 2.5) {\(C\)};
%						\node [event, label = below:{ \( \pi_D = 1 \) }] (D) at (2.5, 0) {\(D\)};
%						
%						\draw [->, spanning] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_1, [9, 28] \)} (A);
%						\draw [->, co]       (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_2, [7, 26] \)} (C);
%						\draw [->, co]       (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_3, [2, 21] \)} (A);
%						\draw [->, spanning] (B) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_4, [1, 20] \)} (D);
%						\draw [->, co]       (D) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_5, [5, 24] \)} (C);
%						\draw [->, spanning] (A) to node[midway, sloped, above, yshift = -2pt]{\scriptsize \( a_6, [3, 22] \)} (C);
%					\end{tikzpicture}
%				\end{figure}
%			\end{frame}
		
			\begin{frame}{Lokalität des Verfahrens}
				\begin{itemize}
					\item Das Simplex-Verfahren findet nur ein lokales Minimum.
					\item Es sind Modifikationen des Algorithmus nötig, um eine globale Konvergenz zu ermöglichen.
				\end{itemize}
			\end{frame}
		% end
		
		\subsection{Verbesserungen der globalen Konvergenz}
			\begin{frame}{Änderung der Lösung durch Spannungen}
				Jede Spannung \( \vec{x} \) (mit \( \mat{\Gamma} \vec{x} \equiv_T \vec{0} \)) definiert mit
				\begin{equation*}
					\vec{y}' \coloneqq [\vec{y} + \vec{x}]_T
				\end{equation*}
				eine neue Lösung von \( \mat{\Gamma} \vec{y}' \equiv_T \vec{b} \). Diese ist gültig, wenn \( \vec{y}' \leq \vec{\delta} \) gilt.
				
				\vspace{0.5cm}
				Diese Lösung ist besser, wenn sich die Zielfunktion \( \vec{\omega}^T \vec{y} \) verbessert.
			\end{frame}
		
			\begin{frame}{Knotenlokale Verbesserungen}
				Ein Knoten \(i\) induziert einen Schnitt \( \eta^{(i)} \) mit \( P = \{\, i \,\} \). Eine Änderung des Potentials \( \pi_i \)
				\begin{equation*}
					\pi_i' \coloneqq \pi_i + \delta
				\end{equation*}
				ist äquivalent zur Änderung der Slack-Zeiten
				\begin{equation*}
					\vec{y}' \coloneqq \vec{y} + \delta\vec{\eta}^{(i)}
				\end{equation*}
				nach \(\delta\)-facher Anwendung des Schnitts.
			\end{frame}
			\note[itemize]{
				\item Knotenlokaler Schnitt: Alle Kanten um den Knoten herum durchschneiden.
				\item Addition von \(\delta\) bei eingehende Kanten, Subtraktion bei ausgehenden.
			}
		% end
	% end
	
	\section{Zusammenfassung}
		\todo{Zusammenfassung}
	% end

	\begin{frame}{Literatur}
		\bibliography{../cite}
	\end{frame}
\end{document}
